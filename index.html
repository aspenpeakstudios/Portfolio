<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">   -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">  
  <!-- <link rel="icon" href="/mountain.ico" type="image/bmp"> -->
  <link rel="icon" type="image/png" href="mountain.png" />
  <title>Mountains and Code</title> 


  <link rel='stylesheet' href='css/global.css' />
  <link rel='stylesheet' href='css/portfolio-main.css' />
  <link rel='stylesheet' href='css/landing.css' />
  <link rel='stylesheet' href='css/hero.css' />
  <link rel='stylesheet' href='css/projects.css' />
  <link rel='stylesheet' href='css/career-slides.css' />
  <!-- <link rel='stylesheet' href='css/work-history-slides.css' /> -->
  <link rel='stylesheet' href='js/components/basicTimeline/basicTimeline.css' />
  <link rel='stylesheet' href='js/components/horizontalSlider/horizontalSlider.css' />
  <link rel='stylesheet' href='css/control-grid.css' />
  <link rel='stylesheet' href='css/contact.css' />
  <link rel='stylesheet' href='css/nav-modal.css' />
  <link rel='stylesheet' href='css/media-queries.css' />  
</head>

<body class='fade'>   
    <div class='nav-modal'></div>

     <!-- Site Navigation -->
     <div id='menutoggle' class='nav-menu' aria-haspopup="true" aria-role="button" aria-controls="site-map" title='show menu' onclick=showMenu()>          
        <img src='~/../img/icons/map.svg' alt='Show Menu'/>                              
    </div>
    
    <main>     
        <!-- Hero Image -->
        <section class='landing'>  

            <!-- Element 1:  Full Page Background -->
            <div class='background scroll' data-rate='0.5' data-transform='scale(1.05)'></div>


            <div class='foreground'>

                <!-- Nav Menu -->
                <div class='home-menu'>
                    <ul>                
                        <li><a href='#about'>About</a></li>                        
                        <li><a href='#projects'>Projects</a></li>
                        <li><a href='#career'>Career</a></li>
                        <li><a href='#contact'>Contact</a></li>                
                    </ul>
                </div>            

                <!-- Element 1:  Text -->
                <div class='profession'>
                    Full Stack | UI Developer | Designer
                </div>

                <!-- Element 2:  Logo -->
                <div class='logo'>
                    <div class='git-page-logo-hack'></div>                
                </div>

                <!-- Element 3:  Carousel Navigation  -->
                <div class='carousel-navigation-container'>
                    <div class='gradient-up animate'></div>                                        
                    <div class='nav-carousel'>            
                        <ul role="radiogroup">
                            <li class='line'></li>
                            <li data-index=0 role="radio" title='Change background image'></li>
                            <li class='line'></li>
                            <li data-index=1 role="radio" title='Change background image'></li>
                            <li class='line'></li>
                            <li data-index=2 role="radio" title='Change background image'></li>
                            <li class='line'></li>  
                            <li data-index=3 role="radio" title='Change background image'></li>
                            <li class='line'></li>                             
                        </ul>
                    </div>
                    <div class='gradient-down animate'></div>
                </div>
            </div>
        </section>

        <!-- About -->
        <section id='about' class='about'>           
            <!-- TEXT -->
            <div class='intro'>     
                <p class='slide-in'>Hi, I'm John</p>            
                <p class='slide-in'>
                    For over two decades I have used my software development and design skills to help companies reach their goals.
                    I take work seriously and make sure projects succeed. 
                    I can lead.
                    I can be led.
                    I like to mentor but am humble enough to recognize everyone can teach me something.  
                    Mountains and Code is a combination of some of my professional work and some of my outside interests.  
                    <!-- Thanks for being here.   -->
                </p>
                <p class='slide-in'>Thanks for being here.</p>
                <!-- <p class='slide-in'>Lets have some fun.</p> -->
            </div>
            
            <!-- Divider -->
            <!-- <div>
                <div class='slant'><div><span>Full Stack Developer</span><span>Pretty Outdoorsy</span></div></div>
            </div> -->
        </section>


        <!-- TODO:  Should be its own component for delayed rendering, and
                    its a good canditate for being dynamic anyway
        -->
        <section class='image-collage'>
            <div class='diagonal-rects'>
                <!-- Row 1 -->
                <div class='row1'>               
                    <div class='about-image image1' data-index=0 aria-haspopup="true" title='Click to expand image'></div> 
                    <div class='about-image image2' data-index=1 aria-haspopup="true" title='Click to expand image'></div> 
                    <div class='about-image image3' data-index=2 aria-haspopup="true" title='Click to expand image'></div>
                </div>       
                <!-- Row 2  -->
                <div class='row2'>
                    <div class='about-image image4' data-index=3 aria-haspopup="true" title='Click to expand image'></div>
                    <div class='about-image image5' data-index=4 aria-haspopup="true" title='Click to expand image'></div>                
                </div>           
            </div>

            <!-- Decorative Gradient -->
            <div class='diagonal-filler'></div>             
        </section>
        
        <!-- Projects -->
        <section id='projects' class='projects'> 
            <div class='projects-collage active' title='Click to toggle image'>
                <div class='explore' role='button'>Explore Projects <img class='chevron-right' src='img/icons/chevron-right.svg' alt='Explore Projects'/></span></div>
            </div>

            <div class='section-heading'> 
                Project Case Studies      
            </div>
            
            <div class='projects-container'>            
                <div class='projects-list hidden'>                                      
                        <div class='project-item-container' role='link' title='Click to view project' data-index=0 onclick='handleProjectsClick(0)'>                        
                            <div class='number'>01</div>
                            <div class='divider'></div>
                            <div class='project'>
                                <span class='title'>Nightlight</span>
                                <div class='summary'>A solution for the question: "So where are you guys?"  I built a GPS mapping and tracking platform with React and React Native so our families could stay up to date on our extended travels.  It was a lot of fun.</div>
                            </div>                                                
                        </div>                    
                        <div class='project-item-container' role='link' title='Click to view project' data-index=1 onclick='handleProjectsClick(1)'>
                            <div class='number'>02</div>
                            <div class='divider'></div>
                            <div class='project'>
                                <span class='title'>Field Time Entry</span>
                                <div class='summary'>Building on the edge of our seats.  This was a three person project to replace an outdated and heavily integrated time keeping system for our company.  It turned out to be wildly successful.</div>
                            </div>                        
                        </div>
                        <div class='project-item-container' role='link' title='Click to view project' data-index=2  onclick='handleProjectsClick(2)'>
                            <div class='number'>03</div>
                            <div class='divider'></div>
                            <div class='project'>
                                <span class='title'>Niagara Animal Hospital</span>
                                <div class='summary'>Our business needed a website and I knew a guy.</div>
                            </div>                        
                        </div>                    

                    <!-- <ul>                    
                        <li class='project-item-container' role='link' title='Click to view project' data-index=0 onclick='handleProjectsClick(0)'>                        
                            <div class='number'>01</div>
                            <div class='divider'></div>
                            <div class='project'>
                                <span class='title'>Nightlight</span>
                                <div class='summary'>A solution for the question: "So where are you guys?"  I built a GPS mapping and tracking platform with React and React Native so our families could stay up to date on our extended travels.  It was a lot of fun.</div>
                            </div>                                                
                        </li>                    
                        <li class='project-item-container' role='link' title='Click to view project' data-index=1 onclick='handleProjectsClick(1)'>
                            <div class='number'>02</div>
                            <div class='divider'></div>
                            <div class='project'>
                                <span class='title'>Field Time Entry</span>
                                <div class='summary'>Building on the edge of our seats.  This was a three person project to replace an outdated and heavily integrated time keeping system for our company.  It turned out to be wildly successful.</div>
                            </div>                        
                        </li>
                        <li class='project-item-container' role='link' title='Click to view project' data-index=2  onclick='handleProjectsClick(2)'>
                            <div class='number'>03</div>
                            <div class='divider'></div>
                            <div class='project'>
                                <span class='title'>Niagara Animal Hospital</span>
                                <div class='summary'>Our business needed a website and I knew a guy.</div>
                            </div>                        
                        </li>
                    </ul> -->
                </div>
            </div>   
        </section>

        
        <!-- Work -->
        <section id='career' class='work'>
            <!-- Slider and other components -->           
            <div class='slideshow-container'>         
                <div class='bg10 flex-row-apart'>
                    <!-- <div>
                        <button class='timeline-shutdown'>Deconstruct</button>
                    </div> -->
                    <div class='space-between p10-20'>
                        <div><!--Career--></div>                    
                        <div class='control-grid'></div>
                    </div>
                </div>
                <div class='section-heading'> 
                    Career History     
                </div>
                <div id='workHistorySlider1' class='horizontalSlider -bg9'></div>
                <div class='basic-timeline'></div>
            </div>
        </section>
        
    
        <!-- Contact -->
        <section id='contact' class='contact' >
            <!-- Contents -->
            <div class='contact-content'>
                <!-- Heading -->
                <h1>I'm looking for a homebase</h1>
                <!-- Paragraph -->
                <p>A group of like minded individuals dedicated to creating great work on interesting projects.  If you have looked at my work and think I would be a good fit on your team, please send me an email and lets talk. </p>
                <!-- Links -->
                <div class='contact-links'>
                    <div role='button'><img src='~/../img/icons/mail.svg' alt='get email address'/></div>
                    <!-- <div role='button'><img src='~/../img/icons/info.svg' alt='site information'/></div> -->
                </div>
            </div>
                
        </section>

        <!-- Footer -->
        <footer>
            <a href='/'>            
                <div class='mountains'>Mountains</div>
                <div class='andcode'>and code</div>            
            </a>
        </footer>

    </main>
</body>

<script src="/js/intersectionObserver.js"></script>
<script src="/Portfolio/js/intersectionObserver.js"></script>

<script src="/js/routing.js"></script>
<script src="/Portfolio/js/routing.js"></script>

<script src="/js/landing.js"></script>
<script src="/Portfolio/js/landing.js"></script>

<script type="module" src="/js/hero.js"></script>
<script type="module" src="/Portfolio/js/hero.js"></script>

<script src="/js/controlGrid.js"></script>
<script src="/Portfolio/js/controlGrid.js"></script>

<script src="/data/events.js"></script>
<script src="/Portfolio/data/events.js"></script>

<script src="/js/components/basicTimeline/basicTimeline.js"></script>
<script src="/Portfolio/js/components/basicTimeline/basicTimeline.js"></script>

<script src="/js/components/horizontalSlider/horizontalSlider.js"></script>
<script src="/Portfolio/js/components/horizontalSlider/horizontalSlider.js"></script>


<script>    
    console.log("document is loaded");
    resetBody();      

    // Update version number
    //const VERSION_NUMBER = "[0131-12/6/2022]";
    // document.querySelector('.version-number').innerHTML = VERSION_NUMBER;

    
    // Current index shared amongst the slider, timeline and control grid;
    let selectedIndex = 2;

    function handleProjectsClick(index) {
        // console.log("handle projects click", index);
        switch(index) {
            case 0: 
                navigateToPage('home', 'projects/nightlight')
                break;
            case 1: 
                navigateToPage('home', 'projects/fte')
                break;
            case 2: 
                navigateToPage('home', 'projects/nah')
                break;
            default:
                console.log("No Project Found");
        }
    }


    function renderSlide(item) {
        let summaryText = '';
        if (item.link) {
            summaryText = `${item.summary} <a href="${item.link}"><span>More<span></a>`;
        }
        else {
            summaryText = `${item.summary}`;
        }

        let backgroundDetails = '';
        if (item.backgroundTextDetails) {
            backgroundDetails = `
                        <div class='hero-text-details-container'>
                            <p>${item.backgroundTextDetails}</p>
                        </div>
                        `;
        }

        let html = 
        `
            <div class='card hide-content'>
                <div class='image-container'>        
                    <div class='hero-image-container'>
                        <img src='~/../img/${item.backgroundImage}' alt='${item.backgroundAlt}'/>
                        <div class='hero-text-container'>
                            <a href='${item.backgroundLink}' target='new'>${item.backgroundText}</a>
                        </div>
                        ${backgroundDetails}
                    </div>
                    <div class='avatar-image-container'>
                        <img src='~/../img/${item.brandImage}' alt='${item.brandAlt}'/>
                    </div>
                    <div class='location-image-container'>
                        <img src='~/../img/collage/location.png' alt='Location Icon'/>
                    </div>
                </div>
                <div class='details'>
                    <div class='header'><h1>${item.company}</h1></div>        
                    <div class='body'><p>${summaryText}</p></div>        
                    <div class='footer'>
                        <div class='years'><span>${item.yearStart}</span><span>-${item.yearEnd}</span></div>
                        <div class='job-title'>${item.title}</div>
                    </div>
                </div>                    
            </div>            
        `;        
        return html;
    }


    // Dynamically generates the event handlers for the slides.
    // 1.  Click on 'more' link navigates to career page
    // 2.  Click on 'location' icon toggles hero image panel to expand/contract.
    //     A.  on card mouse-out contract the hero image panel.
    //     B.  on scroll, contract the hero image panel.
    function generateSlideEventHandlers() {
        const locationIcons = document.querySelectorAll('.card .location-image-container');
        locationIcons.forEach((el) => {
            el.addEventListener('pointerdown', (e) => {                
                toggleLocationInformation(el);
             })
        });

        const links = document.querySelectorAll('.card .details p a');
        links.forEach((el) => {
            el.addEventListener('click', (e) => {
                console.log('click', e.target, e.target.parentNode);
                const el = (e.target.href) ? e.target : e.target.parentNode;

                const href = el.href;
                console.log('href:', href);
                if (href) {
                    e.preventDefault();                    
                    routeToUrl(href);      // routing.js - handles a link click.
                    return false;
                }                
             })
        });
    }

    function toggleLocationInformation(el) {
        const parent = el.parentNode;

        if (parent.classList.contains('active')) {
            parent.classList.remove('active');
        }
        else {
            parent.classList.add('active');
        }
    }

    function resetSlide(el) {
        console.log('reset slide', el);

        const target = el.querySelector('.image-container');
        if (target) {

            if (target.classList.contains('active')) {
                target.classList.remove('active');
            }
        }        
    }

    // DELAYED JAVASCRIPT COMPONENTS
    delayedComponentLoad(0);
    
    // TEST Projects Button
    const exploreProjectsButton = document.querySelector('.projects-collage').addEventListener('click', handleExploreProjects);

    function handleExploreProjects() {
        console.log("Click");  
        const projectImage = document.querySelector('.projects-collage');
        const projectList = document.querySelector('.projects-list');
        if (projectImage.classList.contains('active')) {
            projectImage.classList.remove('active');

            projectList.classList.remove('hidden');
        }
        else {        
            projectImage.classList.add('active');
            projectList.classList.add('hidden');
        }
    };

    // document.querySelector('.timeline-shutdown').addEventListener('click', (e) => {
    //     console.log("destroy");
    //     slider1.destroy();
    //     controlGrid1.destroy();
    //     basicTimeline1.destroy();
    // });

    
    const links = document.querySelectorAll('.home-menu ul li a').forEach((el) =>{
        el.addEventListener('click', handleMenuClick);
    });    

    // TODO move this to Routing component
    // Testing menu clicks
    function handleMenuClick(e) {
        console.log('handleMenuClick: ', e);
        e.preventDefault();
        const s = e.target.href;
        const id = s.substring(s.indexOf('#'));
        console.log('Href: ', s, id);

        const target = document.querySelector(id);
        target.scrollIntoView({behavior: "smooth"});

        return false;
    }

    
    function delayedComponentLoad(delay) {

        // HACK - have each component fade themselves in.
        let workContainer = document.querySelector('.work');
        workContainer.style.opacity = 0;    

        //setTimeout(() => {

            //console.log("Loading JS components");
            //console.time('components');

            // App loads    
            let slideContainer1 = document.getElementById('workHistorySlider1');
            //slideContainer1.style.opacity = 0;    
            
            // const slider1 = new HorizontalSlider(slideContainer1, events, renderSlide, 100, false, 0, generateSlideEventHandlers);
            const slider1 = new HorizontalSlider(slideContainer1, cardData, renderSlide, 100, false, selectedIndex, 0.8, 0.5, generateSlideEventHandlers, resetSlide);
            setTimeout(()=>{workContainer.style.opacity = 1;}, 100);

            // Create basic timeline
            const basicTimelineEl = document.querySelector('.basic-timeline');
            const basicTimeline1 = new BasicTimeline(basicTimelineEl, events, selectedIndex, true);

            // Create control grid    
            let controlGridContainer1 = document.querySelector('.control-grid');
            const controlGrid1 = new ControlGrid(controlGridContainer1, events.length, selectedIndex, 'line');

            slideContainer1.addEventListener('onslide', (e) => {
                //console.log("Caught Event: onSlide", e);      
                if (e.detail.index != selectedIndex) {
                    selectedIndex = e.detail.index;
                    basicTimeline1.setIndex(e.detail.index);
                    controlGrid1.setIndex(selectedIndex);
                }
            });

            controlGridContainer1.addEventListener('onindexchange', (e) => {        
                //console.log("Caught Event: onindexchange", e);      
                if (e.detail.index != selectedIndex) {
                    selectedIndex = e.detail.index;
                    basicTimeline1.setIndex(e.detail.index);
                    slider1.setIndex(e.detail.index);
                }
            })

            basicTimelineEl.addEventListener('onindexchange', (e) => {  
                //console.log("Caught Event: onindexchange", e);      
                if (e.detail.index != selectedIndex) {
                    selectedIndex = e.detail.index;
                    controlGrid1.setIndex(selectedIndex);
                    slider1.setIndex(e.detail.index);
                }
            }); 

            /*  HANDLE RESIZE  */
            window.onresize = () => {  
                console.log("Resize Event Detected"); 

                slider1.handleResize();
                basicTimeline1.handleResize();        
            }     
                        
            //console.log("Finished loading JS components");
            //console.timeEnd('components');

        //}, delay);
    }


    // Intersection Observer for projects section    
    addObserver({
        selectors: '.projects-collage', 
        fireOnce: true,
        whenIntersecting: (entry) => {console.log("is intersecting"); handleExploreProjects(); },
        threshold: 0.9
        // whenNotIntersecting: (entry) => {console.log("is not intersecting"); handleExploreProjects(); }
    });

    // Intersection Observer for slide-ins
    addObserver({
        selectors: '.slide-in',
        fireOnce: true,             
        whenIntersecting: (entry) => { entry.target.classList.add('visible'); },
    });  
    
    // Intersection Observer for the site map
    addObserver({
        selectors: '.landing',        
        whenIntersecting: (entry) => { document.querySelector('.nav-menu').classList.remove('visible'); },
        whenNotIntersecting: (entry) => { document.querySelector('.nav-menu').classList.add('visible'); },
    });  
        


</script>

</html>